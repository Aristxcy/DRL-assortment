2022-12-11 18:05:23,238 Train INFO: Namespace(logger=<Logger Train (INFO)>, name='A2C2022-12-11-18-05-23', gpu='0', device=device(type='cuda', index=0), gamma=1, epoch_num=3000, test_episode=50, val_episode=50, test_size=0.1, val_size=0.5, batch_size=50, train_batch_size=50, num_steps=10, h=1, w=[120, 50], nn_out=40, share_lr=0.0001, actor_lr=1e-05, critic_lr=0.01, step=10, lr_min=1e-05, e_rate=0.001, a_rate=1, c_rate=1, lr_decay_lambda=0.999, duse_T=True, est_T=False, use_pref=False, same_price=False, use_price=True, only_test=False, test_benchmark=False, change_T=True, num='0', print_grad=False, max_norm=10, seed_range=20, net_seed=10, seed=0, info=True, selling_length=100, cardinality=4, ini_inv=10, num_products=10, number_samples=10000, num_cus_types=4, seg_prob=None, num_cus_features=4, MNLdata=10000, p_file='../Gene_databeta/simul/p10_random.npy', c_file='../Gene_databeta/simul/c4_random.npy')
2022-12-11 18:05:23,239 Train INFO: log/A2C2022-12-11-18-05-23
2022-12-11 18:05:25,084 Train INFO: products price: [949.73814547 427.61563842 231.02871698 660.34237971  25.13091995
 223.26577906 348.06358099 635.59336555 495.40725861 364.01482778]
2022-12-11 18:05:25,084 Train INFO: seg_prob [0.21154331 0.33382619 0.24539256 0.20923794]
2022-12-11 18:05:25,084 Train INFO: Load Factor 1.0
2022-12-11 18:05:25,120 Train INFO: start epoch: 1 / 3000
2022-12-11 18:05:25,120 Train INFO: learning rate now: 0.0001,1e-05,0.01
2022-12-11 18:05:26,448 Train INFO: train reward:
2022-12-11 18:05:26,697 Train INFO: mean validate reward: 33.6427
2022-12-11 18:05:26,699 Train INFO: model weights saved
2022-12-11 18:05:27,080 Train INFO: train reward:
2022-12-11 18:05:27,362 Train INFO: mean validate reward: 36.9502
2022-12-11 18:05:27,364 Train INFO: model weights saved
2022-12-11 18:05:27,775 Train INFO: train reward:
2022-12-11 18:05:28,082 Train INFO: mean validate reward: 42.0059
2022-12-11 18:05:28,084 Train INFO: model weights saved
2022-12-11 18:05:28,428 Train INFO: train reward:
2022-12-11 18:05:28,739 Train INFO: mean validate reward: 36.8096
2022-12-11 18:05:29,099 Train INFO: train reward:
2022-12-11 18:05:29,307 Train INFO: mean validate reward: 29.7677
2022-12-11 18:05:29,666 Train INFO: train reward:
2022-12-11 18:05:29,930 Train INFO: mean validate reward: 39.3584
2022-12-11 18:05:30,315 Train INFO: train reward:
2022-12-11 18:05:30,564 Train INFO: mean validate reward: 35.8691
2022-12-11 18:05:30,942 Train INFO: train reward:
2022-12-11 18:05:31,191 Train INFO: mean validate reward: 38.2438
2022-12-11 18:05:31,550 Train INFO: train reward:
2022-12-11 18:05:31,788 Train INFO: mean validate reward: 36.1023
2022-12-11 18:05:32,127 Train INFO: train reward:
2022-12-11 18:05:32,355 Train INFO: mean validate reward: 33.5625
2022-12-11 18:05:32,687 Train INFO: train reward:
2022-12-11 18:05:32,944 Train INFO: mean validate reward: 38.8989
2022-12-11 18:05:33,319 Train INFO: train reward:
2022-12-11 18:05:33,574 Train INFO: mean validate reward: 31.4139
2022-12-11 18:05:33,977 Train INFO: train reward:
2022-12-11 18:05:34,210 Train INFO: mean validate reward: 35.7083
2022-12-11 18:05:34,520 Train INFO: train reward:
2022-12-11 18:05:34,732 Train INFO: mean validate reward: 33.0396
2022-12-11 18:05:35,059 Train INFO: train reward:
2022-12-11 18:05:35,281 Train INFO: mean validate reward: 34.9793
2022-12-11 18:05:35,673 Train INFO: train reward:
2022-12-11 18:05:35,956 Train INFO: mean validate reward: 41.3275
2022-12-11 18:05:36,292 Train INFO: train reward:
2022-12-11 18:05:36,527 Train INFO: mean validate reward: 34.6175
2022-12-11 18:05:36,873 Train INFO: train reward:
2022-12-11 18:05:37,139 Train INFO: mean validate reward: 39.8090
2022-12-11 18:05:37,534 Train INFO: train reward:
2022-12-11 18:05:37,822 Train INFO: mean validate reward: 42.2469
2022-12-11 18:05:37,824 Train INFO: model weights saved
2022-12-11 18:05:38,178 Train INFO: train reward:
2022-12-11 18:05:38,511 Train INFO: mean validate reward: 37.0418
2022-12-11 18:05:38,915 Train INFO: train reward:
2022-12-11 18:05:39,166 Train INFO: mean validate reward: 37.0404
2022-12-11 18:05:39,606 Train INFO: train reward:
2022-12-11 18:05:39,873 Train INFO: mean validate reward: 38.1518
2022-12-11 18:05:40,209 Train INFO: train reward:
2022-12-11 18:05:40,524 Train INFO: mean validate reward: 34.7127
2022-12-11 18:05:40,926 Train INFO: train reward:
2022-12-11 18:05:41,268 Train INFO: mean validate reward: 36.9758
2022-12-11 18:05:41,676 Train INFO: train reward:
2022-12-11 18:05:41,918 Train INFO: mean validate reward: 34.7137
2022-12-11 18:05:42,319 Train INFO: train reward:
2022-12-11 18:05:42,579 Train INFO: mean validate reward: 37.0629
2022-12-11 18:05:42,977 Train INFO: train reward:
2022-12-11 18:05:43,237 Train INFO: mean validate reward: 36.6283
2022-12-11 18:05:43,603 Train INFO: train reward:
2022-12-11 18:05:43,823 Train INFO: mean validate reward: 28.8200
2022-12-11 18:05:44,187 Train INFO: train reward:
2022-12-11 18:05:44,450 Train INFO: mean validate reward: 35.2388
2022-12-11 18:05:44,793 Train INFO: train reward:
2022-12-11 18:05:45,055 Train INFO: mean validate reward: 35.2340
2022-12-11 18:05:45,418 Train INFO: train reward:
2022-12-11 18:05:45,665 Train INFO: mean validate reward: 33.4896
2022-12-11 18:05:45,997 Train INFO: train reward:
2022-12-11 18:05:46,280 Train INFO: mean validate reward: 27.9019
2022-12-11 18:05:46,630 Train INFO: train reward:
2022-12-11 18:05:46,873 Train INFO: mean validate reward: 33.0271
2022-12-11 18:05:47,217 Train INFO: train reward:
2022-12-11 18:05:47,471 Train INFO: mean validate reward: 36.4922
2022-12-11 18:05:47,868 Train INFO: train reward:
2022-12-11 18:05:48,118 Train INFO: mean validate reward: 34.1832
2022-12-11 18:05:48,482 Train INFO: train reward:
2022-12-11 18:05:48,713 Train INFO: mean validate reward: 32.5050
2022-12-11 18:05:49,106 Train INFO: train reward:
2022-12-11 18:05:49,435 Train INFO: mean validate reward: 36.3607
2022-12-11 18:05:49,809 Train INFO: train reward:
2022-12-11 18:05:50,072 Train INFO: mean validate reward: 37.0938
2022-12-11 18:05:50,482 Train INFO: train reward:
2022-12-11 18:05:50,754 Train INFO: mean validate reward: 39.5962
2022-12-11 18:05:51,155 Train INFO: train reward:
2022-12-11 18:05:51,433 Train INFO: mean validate reward: 38.5753
2022-12-11 18:05:51,774 Train INFO: train reward:
2022-12-11 18:05:52,002 Train INFO: mean validate reward: 33.4221
2022-12-11 18:05:52,344 Train INFO: train reward:
2022-12-11 18:05:52,617 Train INFO: mean validate reward: 39.7432
2022-12-11 18:05:53,034 Train INFO: train reward:
2022-12-11 18:05:53,316 Train INFO: mean validate reward: 41.7670
2022-12-11 18:05:53,666 Train INFO: train reward:
2022-12-11 18:05:53,877 Train INFO: mean validate reward: 29.8032
2022-12-11 18:05:54,286 Train INFO: train reward:
2022-12-11 18:05:54,563 Train INFO: mean validate reward: 40.4826
2022-12-11 18:05:54,877 Train INFO: train reward:
2022-12-11 18:05:55,099 Train INFO: mean validate reward: 32.6894
2022-12-11 18:05:55,500 Train INFO: train reward:
2022-12-11 18:05:55,737 Train INFO: mean validate reward: 35.0209
2022-12-11 18:05:56,100 Train INFO: train reward:
2022-12-11 18:05:56,350 Train INFO: mean validate reward: 36.5991
2022-12-11 18:05:56,683 Train INFO: train reward:
2022-12-11 18:05:56,929 Train INFO: mean validate reward: 36.5763
2022-12-11 18:05:57,288 Train INFO: train reward:
2022-12-11 18:05:57,579 Train INFO: mean validate reward: 35.2406
2022-12-11 18:05:57,579 Train INFO: start epoch: 51 / 3000
2022-12-11 18:05:57,579 Train INFO: learning rate now: 9.502544225688341e-05,9.502544225688347e-06,0.00950254422568834
