2022-11-27 21:42:15,727 Train INFO: Namespace(logger=<Logger Train (INFO)>, name='A2C2022-11-27-21-42-15', gpu='0', device=device(type='cuda', index=0), gamma=1, epoch_num=100, train_episode=2000, test_episode=40, val_episode=40, test_size=0.1, val_size=0.5, batch_size=40, train_batch_size=50, num_steps=10, h=1, w=[120, 50], nn_out=40, share_lr=0.001, actor_lr=0.001, critic_lr=0.01, e_rate=0.001, a_rate=1, c_rate=1, lr_decay_lambda=0.99999999, duse_T=True, est_T=False, use_pref=False, same_price=False, use_price=True, only_test=False, change_T=True, num='43', print_grad=False, max_norm=10, seed_range=1, net_seed=10, info=True, selling_length=80, cardinality=4, ini_inv=10, num_products=10, number_samples=10000, num_cus_types=4, seg_prob=[0.4, 0.3, 0.1, 0.2], num_cus_features=6, p_file='prod10.npy', c_file='c4.npy')
2022-11-27 21:42:15,727 Train INFO: log/A2C2022-11-27-21-42-15
2022-11-27 21:42:23,423 Train INFO: Load Factor 0.8
2022-11-27 21:42:35,439 Train INFO: mean test reward1: [20.185513353562325, 17.264757817737422, 14.960973431431135, 16.235973131165636, 18.734933261161114, 18.81896908534137, 17.650461161616423, 13.794907032674324, 13.568962444454577, 16.33514198601616, 15.42934141264344, 14.728338282212007, 14.178167702669361, 15.830721131593906, 14.447535073512249, 19.720478838049253, 15.72874187157409, 16.126393554738193, 19.161025734459926, 15.326204355829494, 13.196417408980398, 14.677724965071874, 19.78270304081018, 15.1000879607441, 14.577750993148905, 13.942874477652078, 13.925154288898824, 16.151653016611817, 13.69269304550832, 14.854167662188562, 12.364096381739035, 15.774222825302699, 11.668045558277965, 17.70786602989783, 14.60609825544042, 13.872922407629124, 15.975969078452803, 18.777701157119978, 14.457027045592978, 14.415150882694219]
2022-11-27 21:42:35,439 Train INFO: mean test reward2: [19.4287005064463, 19.85530516590387, 17.206190321393475, 17.672120953218528, 22.707855804127643, 20.96806739755115, 16.236488391301524, 21.733048830704714, 18.916324825574012, 17.754667039797578, 16.073567100964166, 17.346125232576306, 21.497333002806847, 18.825597282676245, 17.66284041476862, 22.422945666006026, 19.27096207934504, 16.62544362666645, 19.020885751415427, 17.234643091904815, 19.39374562955183, 18.7314375660226, 17.841810583499612, 21.133170125771347, 21.099195253453296, 20.639641620758102, 15.306639382251484, 14.996347896254088, 21.971490902268965, 19.037848533065787, 21.23563159209272, 20.11068216543826, 19.768132373487656, 21.528275746603807, 19.5225852283781, 18.112521945462657, 19.533427144815363, 19.608660093679113, 19.668805039177663, 19.927685214935536]
2022-11-27 21:42:35,440 Train INFO: mean test reward3: [22.698135599046736, 22.64588472509508, 21.206637305039614, 19.44286771415764, 22.66339967143188, 22.5899571159084, 20.151663382761726, 20.67046636199695, 21.16762653697338, 21.413997958215898, 20.341656072130583, 22.244243263510075, 21.050916142010138, 21.387172439454915, 18.958336261261792, 21.759711810614228, 22.053786172865742, 21.258276795186422, 21.37926203060104, 20.53211316277491, 20.670466361996954, 19.64976396605845, 21.03354817820271, 22.525046472209837, 20.670466361996954, 20.32475250959863, 20.670466361996958, 19.52877873064383, 20.169031346569156, 21.932800937451123, 21.708072320467416, 21.932800937451123, 22.64159660605521, 20.70473788833634, 20.778644845135286, 22.589957115908398, 21.05091614201014, 20.843555488833857, 19.961670693392872, 21.759711810614217]
2022-11-27 21:42:35,440 Train INFO: mean test reward4: [14.971567435096832, 17.689418331379738, 13.954624841114828, 14.166105391559109, 18.029074125380337, 12.416243353311536, 15.420223259489614, 16.89258222823309, 15.675126592557032, 15.692494556364464, 14.511819243957433, 22.001933550789133, 21.23291268357163, 14.8699544175077, 19.58208356653021, 13.86381432178392, 14.027752192337061, 15.17369157712923, 14.342659668083678, 15.648301073796052, 17.516793605818314, 16.89259229554172, 19.014106044943897, 15.42022325948961, 18.44921222187301, 15.437591223297042, 15.630462962504009, 15.627482766124224, 13.881182285591349, 16.28867970939494, 16.993535759727255, 20.442134586965146, 14.555706427856054, 14.91878824406181, 16.764631200033318, 15.057141443283856, 17.810453866027444, 17.294519869321704, 13.643182515055878, 19.072738142248532]
2022-11-27 21:42:35,440 Train INFO: mean test reward: 15.6937,19.1907,21.1691,16.2718
2022-11-27 21:42:35,445 Train INFO: start epoch: 1 / 100
2022-11-27 21:42:36,047 Train INFO: mean validate reward: 15.8974
2022-11-27 21:42:36,633 Train INFO: mean validate reward: 19.0742
2022-11-27 21:42:37,219 Train INFO: mean validate reward: 17.7936
2022-11-27 21:42:37,767 Train INFO: mean validate reward: 17.1425
2022-11-27 21:42:38,382 Train INFO: mean validate reward: 17.6412
2022-11-27 21:42:38,942 Train INFO: mean validate reward: 16.7781
2022-11-27 21:42:39,487 Train INFO: mean validate reward: 18.7717
2022-11-27 21:42:39,979 Train INFO: mean validate reward: 17.0842
2022-11-27 21:42:40,527 Train INFO: mean validate reward: 19.1657
2022-11-27 21:42:41,018 Train INFO: mean validate reward: 18.3082
2022-11-27 21:42:41,638 Train INFO: mean validate reward: 20.6745
2022-11-27 21:42:42,224 Train INFO: mean validate reward: 19.9927
2022-11-27 21:42:42,776 Train INFO: mean validate reward: 19.3615
2022-11-27 21:42:43,288 Train INFO: mean validate reward: 17.8966
2022-11-27 21:42:43,905 Train INFO: mean validate reward: 20.3087
2022-11-27 21:42:44,461 Train INFO: mean validate reward: 19.3000
2022-11-27 21:42:45,063 Train INFO: mean validate reward: 19.5062
2022-11-27 21:42:45,569 Train INFO: mean validate reward: 17.5685
2022-11-27 21:42:46,276 Train INFO: mean validate reward: 20.7002
2022-11-27 21:42:46,847 Train INFO: mean validate reward: 18.7740
2022-11-27 21:42:47,396 Train INFO: mean validate reward: 18.4688
2022-11-27 21:42:48,015 Train INFO: mean validate reward: 20.9564
2022-11-27 21:42:48,649 Train INFO: mean validate reward: 21.2897
2022-11-27 21:42:49,288 Train INFO: mean validate reward: 20.4009
2022-11-27 21:42:49,880 Train INFO: mean validate reward: 19.3435
2022-11-27 21:42:50,448 Train INFO: mean validate reward: 19.5061
2022-11-27 21:42:51,032 Train INFO: mean validate reward: 17.9134
2022-11-27 21:42:51,647 Train INFO: mean validate reward: 17.2377
2022-11-27 21:42:52,231 Train INFO: mean validate reward: 17.7999
2022-11-27 21:42:52,817 Train INFO: mean validate reward: 18.4158
2022-11-27 21:42:53,458 Train INFO: mean validate reward: 16.8357
2022-11-27 21:42:54,091 Train INFO: mean validate reward: 18.4299
2022-11-27 21:42:54,672 Train INFO: mean validate reward: 15.9507
2022-11-27 21:42:55,250 Train INFO: mean validate reward: 16.4539
2022-11-27 21:42:55,885 Train INFO: mean validate reward: 16.4606
2022-11-27 21:42:56,442 Train INFO: mean validate reward: 14.6351
2022-11-27 21:42:57,016 Train INFO: mean validate reward: 15.4549
2022-11-27 21:42:57,648 Train INFO: mean validate reward: 16.1590
2022-11-27 21:42:58,141 Train INFO: mean validate reward: 12.5600
2022-11-27 21:42:58,829 Train INFO: mean validate reward: 14.6262
2022-11-27 21:42:58,829 Train INFO: start epoch: 2 / 100
2022-11-27 21:42:59,351 Train INFO: mean validate reward: 13.6274
2022-11-27 21:42:59,944 Train INFO: mean validate reward: 14.9413
2022-11-27 21:43:00,463 Train INFO: mean validate reward: 12.9625
2022-11-27 21:43:01,033 Train INFO: mean validate reward: 14.3971
2022-11-27 21:43:01,622 Train INFO: mean validate reward: 14.8032
2022-11-27 21:43:02,135 Train INFO: mean validate reward: 13.1375
2022-11-27 21:43:02,743 Train INFO: mean validate reward: 14.5167
2022-11-27 21:43:03,352 Train INFO: mean validate reward: 13.4510
2022-11-27 21:43:03,871 Train INFO: mean validate reward: 10.2755
2022-11-27 21:43:04,528 Train INFO: mean validate reward: 14.0544
2022-11-27 21:43:05,048 Train INFO: mean validate reward: 11.7617
2022-11-27 21:43:05,691 Train INFO: mean validate reward: 14.1204
2022-11-27 21:43:06,314 Train INFO: mean validate reward: 14.0726
2022-11-27 21:43:06,906 Train INFO: mean validate reward: 15.1950
2022-11-27 21:43:07,419 Train INFO: mean validate reward: 13.2641
2022-11-27 21:43:08,031 Train INFO: mean validate reward: 15.7426
2022-11-27 21:43:08,668 Train INFO: mean validate reward: 16.1601
2022-11-27 21:43:09,228 Train INFO: mean validate reward: 16.7732
2022-11-27 21:43:09,786 Train INFO: mean validate reward: 14.6818
2022-11-27 21:43:10,376 Train INFO: mean validate reward: 14.5346
2022-11-27 21:43:11,027 Train INFO: mean validate reward: 16.0678
2022-11-27 21:43:11,503 Train INFO: mean validate reward: 13.0744
2022-11-27 21:43:12,048 Train INFO: mean validate reward: 14.2652
2022-11-27 21:43:12,587 Train INFO: mean validate reward: 13.5784
2022-11-27 21:43:13,211 Train INFO: mean validate reward: 16.6915
2022-11-27 21:43:13,803 Train INFO: mean validate reward: 16.1007
2022-11-27 21:43:14,444 Train INFO: mean validate reward: 16.6216
2022-11-27 21:43:15,058 Train INFO: mean validate reward: 15.7558
2022-11-27 21:43:15,648 Train INFO: mean validate reward: 14.4156
2022-11-27 21:43:16,236 Train INFO: mean validate reward: 15.3423
2022-11-27 21:43:16,850 Train INFO: mean validate reward: 15.7923
2022-11-27 21:43:17,427 Train INFO: mean validate reward: 15.7373
2022-11-27 21:43:17,929 Train INFO: mean validate reward: 12.8723
2022-11-27 21:43:18,468 Train INFO: mean validate reward: 14.6746
2022-11-27 21:43:19,052 Train INFO: mean validate reward: 15.7105
2022-11-27 21:43:19,719 Train INFO: mean validate reward: 16.4064
2022-11-27 21:43:20,344 Train INFO: mean validate reward: 14.8855
2022-11-27 21:43:20,958 Train INFO: mean validate reward: 14.5782
2022-11-27 21:43:21,504 Train INFO: mean validate reward: 14.2698
2022-11-27 21:43:22,150 Train INFO: mean validate reward: 15.2235
2022-11-27 21:43:22,151 Train INFO: start epoch: 3 / 100
2022-11-27 21:43:22,765 Train INFO: mean validate reward: 14.9097
2022-11-27 21:43:23,371 Train INFO: mean validate reward: 13.7601
2022-11-27 21:43:24,035 Train INFO: mean validate reward: 14.7685
2022-11-27 21:43:24,658 Train INFO: mean validate reward: 14.1979
2022-11-27 21:43:25,261 Train INFO: mean validate reward: 14.8045
2022-11-27 21:43:25,990 Train INFO: mean validate reward: 15.7819
2022-11-27 21:43:26,772 Train INFO: mean validate reward: 14.7175
2022-11-27 21:43:27,424 Train INFO: mean validate reward: 15.1958
2022-11-27 21:43:28,125 Train INFO: mean validate reward: 14.4809
2022-11-27 21:43:28,678 Train INFO: mean validate reward: 14.7204
2022-11-27 21:43:29,302 Train INFO: mean validate reward: 14.6403
2022-11-27 21:43:30,121 Train INFO: mean validate reward: 15.0742
2022-11-27 21:43:30,760 Train INFO: mean validate reward: 14.0168
2022-11-27 21:43:31,349 Train INFO: mean validate reward: 14.9979
2022-11-27 21:43:31,985 Train INFO: mean validate reward: 15.6833
2022-11-27 21:43:32,606 Train INFO: mean validate reward: 15.4702
2022-11-27 21:43:33,147 Train INFO: mean validate reward: 14.6432
2022-11-27 21:43:33,750 Train INFO: mean validate reward: 15.1411
2022-11-27 21:43:34,358 Train INFO: mean validate reward: 14.9432
2022-11-27 21:43:34,913 Train INFO: mean validate reward: 14.3337
2022-11-27 21:43:35,426 Train INFO: mean validate reward: 12.6196
2022-11-27 21:43:36,011 Train INFO: mean validate reward: 14.7415
2022-11-27 21:43:36,536 Train INFO: mean validate reward: 13.2222
2022-11-27 21:43:37,087 Train INFO: mean validate reward: 14.9767
2022-11-27 21:43:37,701 Train INFO: mean validate reward: 14.9245
2022-11-27 21:43:38,253 Train INFO: mean validate reward: 13.6788
2022-11-27 21:43:38,805 Train INFO: mean validate reward: 14.0508
2022-11-27 21:43:39,374 Train INFO: mean validate reward: 14.7859
2022-11-27 21:43:39,992 Train INFO: mean validate reward: 15.8693
2022-11-27 21:43:40,636 Train INFO: mean validate reward: 16.0447
2022-11-27 21:43:41,178 Train INFO: mean validate reward: 13.5403
2022-11-27 21:43:41,742 Train INFO: mean validate reward: 13.9128
2022-11-27 21:43:42,295 Train INFO: mean validate reward: 15.0334
2022-11-27 21:43:42,890 Train INFO: mean validate reward: 14.8234
2022-11-27 21:43:43,392 Train INFO: mean validate reward: 12.6246
2022-11-27 21:43:43,999 Train INFO: mean validate reward: 14.4070
2022-11-27 21:43:44,600 Train INFO: mean validate reward: 16.0243
2022-11-27 21:43:45,213 Train INFO: mean validate reward: 15.6648
2022-11-27 21:43:45,793 Train INFO: mean validate reward: 15.0614
2022-11-27 21:43:46,410 Train INFO: mean validate reward: 15.0325
2022-11-27 21:43:46,410 Train INFO: start epoch: 4 / 100
2022-11-27 21:43:46,985 Train INFO: mean validate reward: 14.7816
2022-11-27 21:43:47,599 Train INFO: mean validate reward: 14.8063
2022-11-27 21:43:48,206 Train INFO: mean validate reward: 13.9777
2022-11-27 21:43:48,859 Train INFO: mean validate reward: 16.2736
2022-11-27 21:43:49,463 Train INFO: mean validate reward: 14.3023
2022-11-27 21:43:50,026 Train INFO: mean validate reward: 14.8569
2022-11-27 21:43:50,652 Train INFO: mean validate reward: 15.0933
2022-11-27 21:43:51,236 Train INFO: mean validate reward: 13.7950
2022-11-27 21:43:51,836 Train INFO: mean validate reward: 14.5832
2022-11-27 21:43:52,467 Train INFO: mean validate reward: 13.1516
2022-11-27 21:43:53,174 Train INFO: mean validate reward: 15.3479
2022-11-27 21:43:53,812 Train INFO: mean validate reward: 16.1675
2022-11-27 21:43:54,437 Train INFO: mean validate reward: 14.9241
2022-11-27 21:43:55,077 Train INFO: mean validate reward: 15.4687
2022-11-27 21:43:55,624 Train INFO: mean validate reward: 13.4562
2022-11-27 21:43:56,147 Train INFO: mean validate reward: 13.6238
2022-11-27 21:43:56,663 Train INFO: mean validate reward: 13.3433
2022-11-27 21:43:57,301 Train INFO: mean validate reward: 14.7988
2022-11-27 21:43:57,846 Train INFO: mean validate reward: 13.7380
2022-11-27 21:43:58,376 Train INFO: mean validate reward: 13.7908
2022-11-27 21:43:58,996 Train INFO: mean validate reward: 15.6223
2022-11-27 21:43:59,573 Train INFO: mean validate reward: 13.6801
2022-11-27 21:44:00,141 Train INFO: mean validate reward: 14.5020
2022-11-27 21:44:00,700 Train INFO: mean validate reward: 14.5116
2022-11-27 21:44:01,263 Train INFO: mean validate reward: 13.9600
2022-11-27 21:44:01,785 Train INFO: mean validate reward: 13.4735
2022-11-27 21:44:02,342 Train INFO: mean validate reward: 14.1399
2022-11-27 21:44:02,931 Train INFO: mean validate reward: 14.0274
2022-11-27 21:44:03,436 Train INFO: mean validate reward: 13.9086
2022-11-27 21:44:03,977 Train INFO: mean validate reward: 12.8552
2022-11-27 21:44:04,586 Train INFO: mean validate reward: 13.9477
2022-11-27 21:44:05,131 Train INFO: mean validate reward: 13.6451
2022-11-27 21:44:05,767 Train INFO: mean validate reward: 15.2458
2022-11-27 21:44:06,409 Train INFO: mean validate reward: 14.3621
2022-11-27 21:44:06,968 Train INFO: mean validate reward: 13.4812
2022-11-27 21:44:07,546 Train INFO: mean validate reward: 14.0506
2022-11-27 21:44:08,167 Train INFO: mean validate reward: 14.5447
2022-11-27 21:44:08,780 Train INFO: mean validate reward: 13.5397
2022-11-27 21:44:09,305 Train INFO: mean validate reward: 13.0471
2022-11-27 21:44:09,883 Train INFO: mean validate reward: 15.0623
2022-11-27 21:44:09,884 Train INFO: start epoch: 5 / 100
2022-11-27 21:44:10,444 Train INFO: mean validate reward: 15.9149
2022-11-27 21:44:10,972 Train INFO: mean validate reward: 13.2714
2022-11-27 21:44:11,525 Train INFO: mean validate reward: 13.8624
2022-11-27 21:44:12,171 Train INFO: mean validate reward: 15.2808
2022-11-27 21:44:12,794 Train INFO: mean validate reward: 14.4753
2022-11-27 21:44:13,408 Train INFO: mean validate reward: 13.4290
2022-11-27 21:44:14,011 Train INFO: mean validate reward: 13.2191
2022-11-27 21:44:14,576 Train INFO: mean validate reward: 13.4921
2022-11-27 21:44:15,133 Train INFO: mean validate reward: 14.0619
2022-11-27 21:44:15,860 Train INFO: mean validate reward: 14.8553
2022-11-27 21:44:16,433 Train INFO: mean validate reward: 14.0765
2022-11-27 21:44:17,088 Train INFO: mean validate reward: 13.3557
2022-11-27 21:44:17,597 Train INFO: mean validate reward: 13.0865
2022-11-27 21:44:18,127 Train INFO: mean validate reward: 13.6406
2022-11-27 21:44:18,712 Train INFO: mean validate reward: 14.6939
2022-11-27 21:44:19,288 Train INFO: mean validate reward: 13.9847
2022-11-27 21:44:19,791 Train INFO: mean validate reward: 13.1874
2022-11-27 21:44:20,416 Train INFO: mean validate reward: 18.0786
2022-11-27 21:44:20,951 Train INFO: mean validate reward: 14.2933
2022-11-27 21:44:21,488 Train INFO: mean validate reward: 13.0169
2022-11-27 21:44:22,059 Train INFO: mean validate reward: 13.6560
2022-11-27 21:44:22,579 Train INFO: mean validate reward: 12.8487
2022-11-27 21:44:23,200 Train INFO: mean validate reward: 15.3868
2022-11-27 21:44:23,727 Train INFO: mean validate reward: 13.3374
2022-11-27 21:44:24,389 Train INFO: mean validate reward: 15.1989
2022-11-27 21:44:24,835 Train INFO: mean validate reward: 10.0782
2022-11-27 21:44:25,400 Train INFO: mean validate reward: 14.0506
2022-11-27 21:44:25,897 Train INFO: mean validate reward: 12.3653
2022-11-27 21:44:26,413 Train INFO: mean validate reward: 12.6450
2022-11-27 21:44:26,952 Train INFO: mean validate reward: 12.9281
2022-11-27 21:44:27,495 Train INFO: mean validate reward: 13.5652
2022-11-27 21:44:28,111 Train INFO: mean validate reward: 14.4581
2022-11-27 21:44:28,708 Train INFO: mean validate reward: 12.8385
2022-11-27 21:44:29,279 Train INFO: mean validate reward: 12.7767
2022-11-27 21:44:29,861 Train INFO: mean validate reward: 12.5136
2022-11-27 21:44:30,435 Train INFO: mean validate reward: 14.2454
2022-11-27 21:44:30,996 Train INFO: mean validate reward: 11.3098
2022-11-27 21:44:31,647 Train INFO: mean validate reward: 13.3852
2022-11-27 21:44:32,193 Train INFO: mean validate reward: 10.1293
2022-11-27 21:44:32,845 Train INFO: mean validate reward: 13.5144
2022-11-27 21:44:32,845 Train INFO: start epoch: 6 / 100
2022-11-27 21:44:33,400 Train INFO: mean validate reward: 10.8085
2022-11-27 21:44:33,980 Train INFO: mean validate reward: 10.8403
2022-11-27 21:44:34,574 Train INFO: mean validate reward: 10.9758
2022-11-27 21:44:35,234 Train INFO: mean validate reward: 12.7620
